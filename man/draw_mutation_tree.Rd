% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/draw_mutation_tree.R
\name{draw_mutation_tree}
\alias{draw_mutation_tree}
\title{Draw a mutation-annotated phylogenetic tree}
\usage{
draw_mutation_tree(
  tree_and_sequences_asr,
  file = NULL,
  width = 6,
  height_per_sequence = 0.03,
  lines = list(),
  modified_tip_labels = list(),
  modified_node_labels = list(),
  additional_node_labels = list(),
  tip_text_cex = 0.2,
  tip_text_label_color = "grey70",
  tip_text_nudge = c(0.002, 0),
  tip_text_adj = c(0, 0.5),
  node_text_cex = 0.2,
  node_text_nudge = c(-0.002, -0.015),
  node_text_adj = c(1, 1),
  tip_node_text_aa_mutation_color = "grey30",
  tip_node_text_aa_mutation_special_colors = list(red =
    seqUtils::h3_epitope_positions[["koel"]], orange =
    seqUtils::h3_epitope_positions[["wolf"]]),
  tip_node_text_syn_mutation_color = "grey70",
  line_width = 0.3,
  line_color = "grey50",
  line_text_color = "black",
  line_text_cex = 1,
  line_text_adj = c(1, 1),
  line_text_nudge = c(-0.01, -0.003),
  node_addtext_cex = node_text_cex * 4,
  node_addtext_color = "black",
  node_addtext_nudge = c(-0.004, -0.006),
  node_addtext_adj = c(1, 1),
  node_point_color = "black",
  node_point_cex = 0.8,
  edge_color = "grey80",
  edge_width = NULL,
  x_lim_expand = c(0.02, 0.2),
  y_lim_expand = c(0.02, 0.02),
  node_nums = F
)
}
\arguments{
\item{tree_and_sequences_asr}{A tree_and_sequences object with ancestral sequence
reconstruction, created by \code{convergence::addASRusher()}.}

\item{file}{Output file path. If NULL, displays interactively. Supported formats:
PNG (600 dpi) or PDF.}

\item{width}{Figure width in inches. Default: 6.}

\item{height_per_sequence}{Height per tip in inches. Total height is calculated
as \code{height_per_sequence * n_tips}. Default: 0.03.}

\item{lines}{List of lists defining horizontal reference lines. Each element:
\code{list(height, text, line_color, text_color, line_width, text_cex, text_adj, text_nudge)}.}

\item{modified_tip_labels}{List of lists to customize tip labels. Each element:
\code{list(old_label, new_label, text_color, text_cex)}.}

\item{modified_node_labels}{List of lists to customize node mutation labels. Each element:
\code{list(node, text_color, text_cex)}.}

\item{additional_node_labels}{List of lists to add extra annotations. Each element:
\code{list(node, text, text_color, text_cex, text_adj, text_nudge, point_color, point_cex)}.}

\item{tip_text_cex}{Tip label text size. Default: 0.2.}

\item{tip_text_label_color}{Tip label text color. Default: "grey70".}

\item{tip_text_nudge}{Tip label position offset as \code{c(x, y)} fraction of plot range. Default: \code{c(0.002, 0)}.}

\item{tip_text_adj}{Tip label text justification. Default: \code{c(0, 0.5)}.}

\item{node_text_cex}{Node mutation label text size. Default: 0.2.}

\item{node_text_nudge}{Node label position offset as \code{c(x, y)} fraction of plot range. Default: \code{c(-0.002, -0.015)}.}

\item{node_text_adj}{Node label text justification. Default: \code{c(1, 1)}.}

\item{tip_node_text_aa_mutation_color}{Default color for amino acid mutations. Default: "grey30".}

\item{tip_node_text_aa_mutation_special_colors}{Named list mapping colors to amino acid positions
to highlight, e.g. \code{list(red = c(145, 155), blue = c(189))}. Default: H3 epitope positions.}

\item{tip_node_text_syn_mutation_color}{Color for synonymous mutation counts. Default: "grey70".}

\item{line_width}{Width of horizontal reference lines. Default: 0.3.}

\item{line_color}{Color of horizontal reference lines. Default: "grey50".}

\item{line_text_color}{Color of reference line text. Default: "black".}

\item{line_text_cex}{Reference line text size. Default: 1.}

\item{line_text_adj}{Reference line text justification. Default: \code{c(1, 1)}.}

\item{line_text_nudge}{Reference line text position offset. Default: \code{c(-0.01, -0.003)}.}

\item{node_addtext_cex}{Additional node label text size. Default: \code{node_text_cex * 4}.}

\item{node_addtext_color}{Additional node label text color. Default: "black".}

\item{node_addtext_nudge}{Additional node label position offset. Default: \code{c(-0.004, -0.006)}.}

\item{node_addtext_adj}{Additional node label text justification. Default: \code{c(1, 1)}.}

\item{node_point_color}{Additional node point color. Default: "black".}

\item{node_point_cex}{Additional node point size. Default: 0.8.}

\item{edge_color}{Color of tree edges. Default: "grey80".}

\item{edge_width}{Width of tree edges. If NULL, uses ape default. Default: NULL.}

\item{x_lim_expand}{Plot x-axis expansion as \code{c(left, right)} fractions. Default: \code{c(0.02, 0.2)}.}

\item{y_lim_expand}{Plot y-axis expansion as \code{c(bottom, top)} fractions. Default: \code{c(0.02, 0.02)}.}

\item{node_nums}{Logical; show node numbers for debugging. Default: FALSE.}
}
\value{
If \code{file} is specified, returns the file path. Otherwise, displays plot interactively.
}
\description{
Creates a visualization of a phylogenetic tree with non-synonymous (amino acid)
and synonymous mutations labeled on branches. Supports extensive customization
of labels, colors, and annotations.
}
\section{Annotation parameters}{

}

\section{Tip label styling}{

}

\section{Node mutation styling}{

}

\section{Reference line styling}{

}

\section{Additional node annotation styling}{

}

\section{Tree styling}{

}

\examples{
\dontrun{
# Basic usage
draw_mutation_tree(tree_with_asr)

# Save to file
draw_mutation_tree(tree_with_asr, file = "tree.png")

# With annotations
draw_mutation_tree(
  tree_with_asr,
  lines = list(list(height = 20, text = "Clade A")),
  modified_tip_labels = list(list(old_label = "seq1", text_color = "red"))
)
}

}
